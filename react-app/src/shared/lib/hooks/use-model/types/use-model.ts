/**
 * @module UseModelTypes
 * Типы для хука useModel.
 * Определяет состояния и типы данных для работы с LLM моделями.
 */

/**
 * Статус выполнения операции с моделью.
 * Определяет возможные состояния процесса генерации текста.
 */
export type Status =
  /** Начальное состояние, операция не выполняется */
  | 'idle'
  /** Операция выполняется, генерация в процессе */
  | 'process'
  /** Операция успешно завершена */
  | 'success'
  /** Произошла ошибка при выполнении операции */
  | 'error';

/**
 * Роль отправителя сообщения в чате.
 * Определяет тип участника диалога.
 */
export type ChatMessageRole = 'user' | 'assistant' | 'system';

/**
 * Статус операции с чатом.
 * Используется для отслеживания состояния операций CRUD.
 */
export type ChatOperationStatus =
  | 'idle'
  | 'loading'
  | 'creating'
  | 'updating'
  | 'deleting'
  | 'success'
  | 'error';

/**
 * Интерфейс сообщения чата.
 * Определяет структуру сообщения в чате с поддержкой различных ролей.
 * Синхронизирован с Electron типами для обеспечения совместимости.
 */
export interface ChatMessage {
  /** Уникальный идентификатор сообщения */
  id: string;
  /** Роль отправителя сообщения */
  role: ChatMessageRole;
  /** Содержимое сообщения в формате Markdown */
  content: string;
  /** Временная метка создания сообщения (ISO строка) */
  timestamp: string;
  /** Информация о модели, использованной для генерации ответа */
  model?: {
    /** Название модели */
    name: string;
    /** Версия модели */
    version?: string;
    /** Провайдер модели */
    provider?: string;
  };
  /** Контекстная информация для понимания сообщения */
  context?: {
    /** Предыдущие сообщения для контекста */
    previousMessages?: string[];
    /** Дополнительные метаданные */
    metadata?: Record<string, unknown>;
  };
  /** Дополнительные метаданные сообщения */
  metadata?: Record<string, unknown>;
}

/**
 * Интерфейс контекста чата.
 * Содержит историю сообщений и метаданные для контекстного взаимодействия.
 * Синхронизирован с Electron типами для обеспечения совместимости.
 */
export interface ChatContext {
  /** Массив сообщений чата */
  messages: ChatMessage[];
  /** Максимальное количество сообщений для сохранения в контексте */
  maxContextMessages?: number;
  /** Системный промпт для настройки поведения модели */
  systemPrompt?: string;
  /** Настройки генерации для чата */
  generationSettings?: {
    /** Температура генерации (0.0 - 1.0) */
    temperature?: number;
    /** Максимальное количество токенов в ответе */
    maxTokens?: number;
    /** Дополнительные параметры генерации */
    parameters?: Record<string, unknown>;
  };
  /** Дополнительные метаданные контекста */
  metadata?: Record<string, unknown>;
}

/**
 * Интерфейс параметров использования модели в режиме чата.
 * Расширяет базовые параметры UseModelParams дополнительными полями для чата.
 * Синхронизирован с Electron типами для обеспечения совместимости.
 */
export interface ChatUseModelParams extends UseModelParams {
  /** Уникальный идентификатор чата */
  chatId: string;
  /** Контекст чата с историей сообщений */
  chatContext: ChatContext;
  /** Флаг сохранения истории сообщений в чате */
  saveHistory: boolean;
  /** Максимальная длина контекста для предотвращения превышения лимитов модели */
  maxContextLength?: number;
  /** Настройки генерации для чата */
  generationSettings?: {
    /** Температура генерации (0.0 - 1.0) */
    temperature?: number;
    /** Максимальное количество токенов в ответе */
    maxTokens?: number;
    /** Дополнительные параметры генерации */
    parameters?: Record<string, unknown>;
  };
}

/**
 * Интерфейс ответа модели в режиме чата.
 * Содержит дополнительную информацию о чате и сообщении.
 * Синхронизирован с Electron типами для обеспечения совместимости.
 */
export interface ChatModelResponse {
  /** Уникальный идентификатор чата */
  chatId: string;
  /** Сообщение чата с полной информацией */
  message: ChatMessage;
  /** Базовый ответ модели (строка или фрагмент) */
  response: ModelResponse;
  /** Статус операции с чатом */
  status: ChatOperationStatus;
  /** Временная метка операции */
  timestamp: string;
}
